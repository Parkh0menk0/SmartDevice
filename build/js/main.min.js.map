{"version":3,"sources":["script.js"],"names":["i","ESC_KEYCODE","popup","document","querySelector","close","form","userName","message","isStorageSupport","storage","name","accordion","tel","btnScrollDown","querySelectorAll","window","location","href","scrollDown","onEscPress","evt","keyCode","closeModal","focus","add","overlay","classList","value","addEventListener","reset","remove","getItem","localStorage","err","link","mask","matrix","val","def","replace","this","test","length","a","charAt","setCursorPosition","event","preventDefault","openModal","setItem","contains","panel","toggle","style","maxHeight","scrollHeight","pos","elem","setSelectionRange","range","createTextRange","collapse","moveEnd","moveStart","select"],"mappings":"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","file":"main.min.js","sourcesContent":["'use strict';\n\nvar ESC_KEYCODE = 27;\n\nvar link = document.querySelector('.header__btn--request-a-call');\n\nvar popup = document.querySelector('.modal');\nvar overlay = document.querySelector('.modal-overlay');\nvar close = popup.querySelector('.modal__close');\n\nvar form = popup.querySelector('form');\nvar userName = popup.querySelector('[name=name]');\nvar tel = popup.querySelector('[name=tel]');\nvar message = popup.querySelector('[name=question]');\n\nvar isStorageSupport = true;\nvar storage = {\n  name: '',\n  tel: '',\n  message: ''\n};\n\nvar accordion = document.querySelectorAll(\".accordion\");\nvar i;\n\nvar btnScrollDown = document.querySelector('#scroll_down');\n\nvar tel = document.querySelector('#tel');\n\n/**\n * Функция для перехода к разделу преимущществ.\n * @function\n */\nfunction scrollDown() {\n  window.location.href = \"#advantages\";\n}\n\n/**\n * Функция для закрытия окна формы по нажатии клавиши Esc.\n * @function\n * @param {Object} evt объект события;\n */\nfunction onEscPress(evt) {\n  if (evt.keyCode === ESC_KEYCODE) {\n    closeModal();\n  }\n}\n\n/**\n * Функция открытия окна формы.\n * @function\n */\nfunction openModal() {\n  popup.classList.add('modal-show');\n  overlay.classList.add('modal-show');\n\n  if (storage.name) {\n    userName.value = storage.name;\n    tel.focus();\n  } else {\n    userName.focus();\n  }\n\n  if (storage.tel) {\n    tel.value = storage.tel;\n    message.focus();\n  } else {\n    tel.focus();\n  }\n\n  if (storage.message) {\n    message.value = storage.message;\n  } else {\n    userName.focus();\n  }\n\n  document.addEventListener('keydown', onEscPress);\n}\n\n/**\n * Функция закрытия окна формы.\n * @function\n */\nfunction closeModal() {\n  form.reset();\n  popup.classList.remove('modal-show');\n  overlay.classList.remove('modal-show');\n  document.removeEventListener('keydown', onEscPress);\n}\n\ntry {\n  storage.name = localStorage.getItem('name');\n  storage.tel = localStorage.getItem('tel');\n  storage.message = localStorage.getItem('message');\n} catch (err) {\n  isStorageSupport = false;\n}\n\nif (link) {\n  link.addEventListener('click', function (evt) {\n    evt.preventDefault();\n    openModal();\n  });\n}\n\n/**\n * Функция добавляет маску ввода номера телефона.\n * @function\n * @param {Object} evt объект события;\n */\nfunction mask(event) {\n  var matrix = \"+7 (___) ___ ____\",\n    i = 0,\n    def = matrix.replace(/\\D/g, \"\"),\n    val = this.value.replace(/\\D/g, \"\");\n  if (def.length >= val.length) val = def;\n  this.value = matrix.replace(/./g, function (a) {\n    return /[_\\d]/.test(a) && i < val.length ? val.charAt(i++) : i >= val.length ? \"\" : a\n  });\n  if (event.type == \"blur\") {\n    if (this.value.length == 2) this.value = \"\"\n  } else setCursorPosition(this.value.length, this)\n};\n\nif (close) {\n  close.addEventListener('click', function (evt) {\n    evt.preventDefault();\n    closeModal();\n  });\n}\n\nif (form) {\n  form.addEventListener('submit', function (evt) {\n    if (!userName.value || !tel.value) {\n      evt.preventDefault();\n    } else {\n      if (isStorageSupport) {\n        localStorage.setItem('name', userName.value);\n        localStorage.setItem('tel', tel.value);\n        localStorage.setItem('message', message.value);\n      }\n    }\n  });\n}\n\nif (overlay) {\n  overlay.addEventListener('click', function (evt) {\n    evt.preventDefault();\n    if (overlay.classList.contains('modal-show')) {\n      closeModal();\n    }\n  });\n}\n\nif (accordion) {\n  for (i = 0; i < accordion.length; i++) {\n    accordion[i].addEventListener(\"click\", function () {\n      this.classList.toggle(\"active\");\n      var panel = this.nextElementSibling;\n      if (panel.style.maxHeight) {\n        panel.style.maxHeight = null;\n      } else {\n        panel.style.maxHeight = panel.scrollHeight + \"px\";\n      }\n    });\n  }\n}\n\nif (btnScrollDown) {\n  btnScrollDown.addEventListener('click', scrollDown);\n}\n\n\nfunction setCursorPosition(pos, elem) {\n  elem.focus();\n  if (elem.setSelectionRange) elem.setSelectionRange(pos, pos);\n  else if (elem.createTextRange) {\n    var range = elem.createTextRange();\n    range.collapse(true);\n    range.moveEnd(\"character\", pos);\n    range.moveStart(\"character\", pos);\n    range.select()\n  }\n}\n\nif (tel) {\n  tel.addEventListener(\"input\", mask, false);\n}\n\n"]}